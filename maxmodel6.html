<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>arduivis by cskonopka</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56095763-1', 'auto');
  ga('send', 'pageview');

</script>    
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1><a href="http://cskonopka.github.io/arduivis/">arduivis</a></h1>
        <p>a bi-directional communication paradigm for programming languages & microcontrollers</p>
      
        <a href="http://cskonopka.github.io/arduivis/" style="padding-right: 15px;"><strong>Home</strong></a>
        <a href="http://cskonopka.github.io/arduivis/maxmodels" style="padding-right: 15px;"><strong>MaxMSP</strong></a>
        <a href="http://cskonopka.github.io/arduivis/pdmodels" style="padding-right: 15px;"><strong>Pure Data</strong></a>
        <a href="https://github.com/cskonopka/arduivis" style="padding-right: 15px;"><strong>Github</strong></a>             
        <h3>
   
      </header>
      <section>
<!--         <h3>
 -->

<!-- <pre><code>$ cd cskonopka/arduivis
$ git fetch origin
$ git checkout gh-pages
</code></pre>

<p>If you're using the GitHub for Mac, simply sync your repository and you'll see the new branch.</p>
 -->




<!-- <a name="rather-drive-stick" class="anchor" href="#rather-drive-stick"><span class="octicon octicon-link"></span></a>Methodology</h3>

<p>Each model represents a way to interact with an Arduino via a visual programming language. 

Currently there are 6 models that make up arduivis.</p>
  <ul>
    <li>model #1: output</li>
    <li>model #2: input</li>
    <li>model #3: feedback</li>
    <li>model #4: multiple ouputs</li>
    <li>model #5: multiple inputs</li>
    <li>model #6: multiple feedbacks</li>
  </ul> -->
<!-- 
<h3>
<a name="rather-drive-stick" class="anchor" href="#rather-drive-stick"><span class="octicon octicon-link"></span></a>Getting Started</h3>

 -->

 <h3>
<a name="rather-drive-stick" class="anchor" href="#rather-drive-stick"><span class="octicon octicon-link"></span></a>MaxMSP Model #6: Multiple Feedbacks</h3>

<p><b>Arduino</b></p>
 <pre><code>/* 

~~~~~~~ arduivis - MaxMSP ~~~~~~~
~~~~ model#6: multiple feedbacks ~~~

MaxMSP patch: arduivis_model6_multipleFeedbacks.maxpat

This is an example of to read sliders from MaxMSP. 
An Arduino reads and parses this data, sending
it from the Arduino and back into MaxmSP. This 
feedback data is then sent back to the Arduino
from MaxMSP, controlling the PWM of a LED. 
This is done with several streams of data in 
this example.

synthesized by Christopher Konopka

This example code is in the public domain.

*/

void setup() 
{
  //  Create/open serial port    
    Serial.begin(9600);       

  // Define LED mode 
  // PWM LED
    pinMode(3, OUTPUT);
    pinMode(5, OUTPUT);  
    pinMode(6, OUTPUT);
    pinMode(9, OUTPUT);  
}

void loop() 
{ 
  // Sliders from MaxMSP
    int maxmspSlider1, maxmspSlider2, maxmspSlider3, maxmspSlider4;

  // Feedback from MaxMSP (original output from Arduino)
    int feedbackFromMaxMSP1, feedbackFromMaxMSP2, feedbackFromMaxMSP3,  feedbackFromMaxMSP4;

  // Parse incoming MaxMSP slider values
  // from MaxMSP, to Arduino
    maxmspSlider1 = Serial.parseInt();
    maxmspSlider2 = Serial.parseInt();
    maxmspSlider3 = Serial.parseInt();
    maxmspSlider4 = Serial.parseInt(); 

  // Write parsed slider values to serial buffer
  // [comport] object
  // to MaxMSP, from Arduino
    Serial.print(maxmspSlider1);
    Serial.print(" ");
    Serial.print(maxmspSlider2);
    Serial.print(" ");
    Serial.print(maxmspSlider3);
    Serial.print(" ");
    Serial.print(maxmspSlider4);
    Serial.print(" ");

  // Parse incoming MaxMSP (feedback) values
  // from MaxMSP (feedback), to Arduino 
    feedbackFromMaxMSP1 = Serial.parseInt();
    feedbackFromMaxMSP2 = Serial.parseInt();
    feedbackFromMaxMSP3 = Serial.parseInt();
    feedbackFromMaxMSP4 = Serial.parseInt(); 

  // Write parsed values to LEDs
  // Fading LED
  // from MaxMSP (feedback), to Arduino
    analogWrite(3, feedbackFromMaxMSP1);
    analogWrite(5, feedbackFromMaxMSP2);
    analogWrite(6, feedbackFromMaxMSP3);    
    analogWrite(9, feedbackFromMaxMSP4);

    Serial.print(feedbackFromMaxMSP1);
    Serial.print(" ");
    Serial.print(feedbackFromMaxMSP2);
    Serial.print(" ");
    Serial.print(feedbackFromMaxMSP3);
    Serial.print(" ");
    Serial.println(feedbackFromMaxMSP4);
    
      delay(2);
}
</code></pre>

<!-- <p>This is an example of how to parse a single stream of data. The modular piece of code below represents the information that is packed and then set to the serial buffer. This data is read by the Arduino using the Serial.ParseInt() section of code.</p> -->

<!-- <img src="http://cskonopka.github.io/arduivis/arduivis_MaxMSP_model2_input_pak.png" alt="some_text">
 -->
<!-- <p>The data is first sent from a number box within Max and then to a [pak] object. This information is then packed into a message which is fed to an [atoi] object. The [atoi] takes the incoming message and then converts the ASCii message into an integer so it can be read by the Arduino. Instead of sending this newly packed message into the first inlet of the [atoi] object, I chose to use the third inlet. If you were to place the packed message in the first inlet while the [serial] object is being polled for information, whenever a new message is sent to the serial buffer, there will be a moment where the buffer becomes clogged. By sending the information into the third inlet, the [atoi] object holds the data until it is polled by the [metro] polling the [serial] object. This idea can be seen in full in the completed patch on the following page.</p>

 -->

<p><em>MaxMSP</em></p>

<p>Presentation Mode</p>
       <img src="http://cskonopka.github.io/arduivis/arduivis_MaxMSP_model6_multipleFeedbacks.png" alt="some_text">       

<p>Edit Mode</p>
       <img src="http://cskonopka.github.io/arduivis/arduivis_MaxMSP_model6_multipleFeedbacks_inside.png" alt="some_text">





<!--   <ul>
    <li>Next, open the folder named "model1_output"</li>
      <ul>
        <li> arduivis > MaxMSP > model1_output</li>
        <li> arduivis > PD > model1_output</li>
      </ul>
  </ul>  

  <ul>
    <li>Inside "model1_output" there will be a patch for the VPL and a folder containing the Arduino sketch for this example</li>
      <ul>
        <li>Open the sketch "arduivis_MaxMSP_model1_output.ino" in the Arduino IDE</li>
        <li>Upload the sketch to the Arduino</li>
      </ul>
  </ul>     -->

<!-- 
  <ul>
    <li>For MaxMSP, find the folder model #1</li>
      <ul>
        <li> arduivis > MaxMSP > model1_output</li>
      </ul>
  </ul> -->

      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/cskonopka">cskonopka</a></p>

      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>